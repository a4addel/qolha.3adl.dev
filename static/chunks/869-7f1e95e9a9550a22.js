"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[869],{4051:function(e,n,t){t.d(n,{Z:function(){return p}});var a=t(2086),i=t(6347),r=t(2214),s=t(2596),u=t(1230),o=t(3236),l=t(6753),c=function(e){void 0===e&&(e={});var n=(0,o.useState)(e),t=n[0],a=n[1];return[t,(0,o.useCallback)(function(e){a(function(n){return Object.assign({},n,e instanceof Function?e(n):e)})},[])]};function d(e){for(var n=[],t=0;t<e.length;t++)n.push({start:e.start(t),end:e.end(t)});return n}var m=function(e){t=o.isValidElement(e)?(n=e).props:e;var n,t,a=c({buffered:[],time:0,duration:0,paused:!0,muted:!1,volume:1,playing:!1}),i=a[0],r=a[1],s=(0,o.useRef)(null),u=function(e,n){return function(t){try{n&&n(t)}finally{e&&e(t)}}},m=function(){return r({paused:!1})},p=function(){return r({playing:!0})},f=function(){return r({playing:!1})},x=function(){return r({paused:!0,playing:!1})},h=function(){var e=s.current;e&&r({muted:e.muted,volume:e.volume})},j=function(){var e=s.current;e&&r({duration:e.duration,buffered:d(e.buffered)})},g=function(){var e=s.current;e&&r({time:e.currentTime})},y=function(){var e=s.current;e&&r({buffered:d(e.buffered)})};n=n?o.cloneElement(n,(0,l.pi)((0,l.pi)({controls:!1},t),{ref:s,onPlay:u(t.onPlay,m),onPlaying:u(t.onPlaying,p),onWaiting:u(t.onWaiting,f),onPause:u(t.onPause,x),onVolumeChange:u(t.onVolumeChange,h),onDurationChange:u(t.onDurationChange,j),onTimeUpdate:u(t.onTimeUpdate,g),onProgress:u(t.onProgress,y)})):o.createElement("audio",(0,l.pi)((0,l.pi)({controls:!1},t),{ref:s,onPlay:u(t.onPlay,m),onPlaying:u(t.onPlaying,p),onWaiting:u(t.onWaiting,f),onPause:u(t.onPause,x),onVolumeChange:u(t.onVolumeChange,h),onDurationChange:u(t.onDurationChange,j),onTimeUpdate:u(t.onTimeUpdate,g),onProgress:u(t.onProgress,y)}));var v=!1,w={play:function(){var e=s.current;if(e&&!v){var n=e.play();if("object"==typeof n){v=!0;var t=function(){v=!1};n.then(t,t)}return n}},pause:function(){var e=s.current;if(e&&!v)return e.pause()},seek:function(e){var n=s.current;n&&void 0!==i.duration&&(e=Math.min(i.duration,Math.max(0,e)),n.currentTime=e)},volume:function(e){var n=s.current;n&&(e=Math.min(1,Math.max(0,e)),n.volume=e,r({volume:e}))},mute:function(){var e=s.current;e&&(e.muted=!0)},unmute:function(){var e=s.current;e&&(e.muted=!1)}};return(0,o.useEffect)(function(){var e=s.current;e&&(r({volume:e.volume,muted:e.muted,paused:e.paused}),t.autoPlay&&e.paused&&w.play())},[t.src]),[n,i,w,s]},p=function(e){let{number:n,ar:t,username:l,clipId:c}=e,d=s.d.clip.reject.useMutation(),p=s.d.clip.accept.useMutation(),f=(0,o.useState)(!1),x=(0,u.useSession)(),h=m({src:`/api/clip/${c}/stream`});return(0,a.jsxs)("div",{className:`flex p-1 justify-between ${n%2==0?"bg-slate-200":""}`,children:[(0,a.jsx)("span",{children:t}),(0,a.jsx)("span",{children:l}),h[0],(0,a.jsxs)(i.h,{className:"gap-2",children:[(0,a.jsx)(r.z,{disabled:f[0],onClick:h[2].play,small:!0,icon:"play",text:"play"}),"authenticated"===x.status&&["owner","admin"].includes(x.data?.user?.role||"")&&(0,a.jsx)(r.z,{disabled:f[0],onClick:async()=>{await p.mutateAsync({clipId:c}),f[1](!0)},small:!0,intent:"primary",text:"accept"}),"authenticated"===x.status&&["owner","admin"].includes(x.data?.user?.role||"")&&(0,a.jsx)(r.z,{disabled:f[0],onClick:async()=>{await d.mutateAsync({clipId:c}),f[1](!0)},small:!0,intent:"danger",icon:"trash",text:"reject"})]})]})}},6703:function(e,n,t){t.d(n,{Z:function(){return i}});var a=t(2086);function i(e){return(0,a.jsx)("div",{className:"block mx-auto w-full max-w-4xl px-4 py-2",children:e.children})}},6910:function(e,n,t){t.d(n,{Z:function(){return P}});var a=t(2086),i=t(1230),r=t(7213),s=t(3236),u=t(6031),o=t(8778),l=t(2214),c=t(8683),d=t.n(c),m=t(8156),p=t(199),f=t(5614),x=t(6347),h=t(1497),j=t(7933),g=t(6090),y=t.n(g);function v(e){let{onFinish:n,disabled:t}=e,i=(0,s.useState)(""),r=y()({recordScreen:!1,mediaStreamConstraints:{audio:!0,video:!1},onStop:e=>{let t=URL.createObjectURL(e);i[1](t),n(e,t)}});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.i,{role:"alert"}),(0,a.jsxs)(x.h,{className:"w-full flex justify-around",children:[(0,a.jsx)(l.z,{className:"w-1/2",icon:["recording","paused"].includes(r.status)?(0,a.jsxs)("span",{className:"relative flex h-3 w-3",children:[(0,a.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),(0,a.jsx)("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-red-500"})]}):"record",disabled:t,onClick:()=>["recording","paused"].includes(r.status)?r.stopRecording():r.startRecording(),title:["recording","paused"].includes(r.status)?"Record":"Stop_",text:["recording","paused"].includes(r.status)?"Stop_":"Record"}),(0,a.jsx)(h.i,{}),(0,a.jsx)(l.z,{className:"w-1/2",disabled:t,onClick:()=>"paused"===r.status?r.resumeRecording():r.pauseRecording(),title:"paused"===r.status?"Resume":"Pause ",text:"paused"===r.status?"Resume":"Pause "})]}),(0,a.jsx)(h.i,{role:"alert"}),(0,a.jsx)(f.U,{intent:"primary",icon:"record",className:"text-center",title:r.status}),(0,a.jsx)(h.i,{role:"alert"}),(0,a.jsx)("audio",{src:i[0],controls:!0}),(0,a.jsx)(h.i,{role:"alert"})]})}var w=t(2596),C=t(8594);function b(){let[e,n]=(0,s.useState)(!1),[t,i]=(0,s.useState)(null),[r,u]=(0,s.useState)(null),o=w.d.word.getWordThatNeedsClips.useQuery(),[c,d]=(0,C.ZP)({method:"POST",withCredentials:!0,url:`/api/clip/insert?wordId=${o?.data&&o?.data?.id}`,headers:{"Content-Type":"multipart/form-data"}},{manual:!0}),g=w.d.word.deleteWord.useMutation();async function y(){if(t?.size===0||!t)return;let e=new FormData;e.append("clip",t),await d({data:e}),i(null),u(null),o.refetch()}return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.z,{title:"open",text:"open",onClick:()=>n(!0)}),(0,a.jsxs)(m.V,{isOpen:e,title:"Contribute a Clip",icon:"info-sign",isCloseButtonShown:!0,onClose:()=>n(!1),children:[(0,a.jsxs)(p.a,{children:[(0,a.jsxs)("div",{className:"flex flex-col max-w-xs border p-2 mx-auto",children:[(0,a.jsx)(f.U,{icon:"new-text-box",intent:"primary",title:o.data?.ar}),(0,a.jsx)(v,{disabled:!o.data?.ar,onFinish:function(e,n){i(e),u(n)}}),(0,a.jsxs)(x.h,{nonce:"",children:[(0,a.jsx)(l.z,{className:"w-1/2",intent:"primary",icon:"send-to",title:"send",text:"send",onClick:async()=>{await y(),o.refetch()}}),(0,a.jsx)(h.i,{}),(0,a.jsx)(l.z,{className:"w-1/2",intent:"danger",icon:"delete",title:"delete",text:"delete",onClick:async()=>{o?.data?.id&&(await g.mutateAsync({wordId:o?.data?.id}),o.refetch())}})]})]})," "]}),(0,a.jsx)(j.c,{actions:(0,a.jsx)(l.z,{onClick:()=>n(!1),intent:"primary",text:"Close"})})]})]})}function P(e){let{isSearch:n}=e;(0,i.useSession)(),(0,r.useRouter)();let[t,c]=(0,s.useState)(!1);return(0,a.jsx)(u.w,{children:(0,a.jsxs)(u.w.Group,{align:o.v.LEFT,children:[(0,a.jsx)(u.w.Heading,{children:"Qolha"}),(0,a.jsx)(u.w.Divider,{}),(0,a.jsx)(d(),{href:"/",children:(0,a.jsx)(l.z,{className:"bp5-minimal",icon:"home",text:"Home"})}),(0,a.jsx)(d(),{href:"/word/add",children:(0,a.jsx)(l.z,{className:"bp5-minimal",icon:"add-column-right",text:"add word"})}),(0,a.jsx)(b,{})]})})}}}]);